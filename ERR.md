###　20200620　23:14

今天准备实现蔽障功能，但是运行过程中，红外线模块工作不正常，其pin输入没有根据实际情况进行，针对这一问题，我做了如下测试:

1. 单独测试红外模块，重复运行红外模块，未发现问题
2. 单独运行小车部分，同时摘除红外模块的pin针，测试从pin针读取的数据，没有错误
3. 思考后，可能是因为我的红外线模块的电源是由电池单独供应的，等待测试中,准备将红外模块的供电由树莓派单独供应。思考后，可能是因为我的红外线模块的电源是由电池单独供应的，等待测试中,准备将红外模块的供电由树莓派单独供应。(当我重新使用树莓派供电时，红外线坏掉了)

经过测试，左侧红外线坏掉，它甚至影响了超声波的工作，在左红外线故障期间，超声波无法正常工作(原因不清，电压正常)。去除左侧红外线之后，一切正常。等待明天新的红外线到达，重新测试。

将左侧红外线去掉，在实验情况下，红外线，超声波和小车配合正常(未实际环境运行)

### 20200621 15:06

经过昨天的问题，我觉得有必要编写测试模块对各个模块进行测试，现在进行小车的测试，在昨天，小车除了红外线模块有问题，小车速度在逐渐改变，直至最后不再运动。

现在测试小车的运行，运行时间１分钟，不断的左转右转，直行，后退，观察结果
结果无误，运行一分钟后，未见明显减速。且左转右转角度设置没有明显失误。


### 20200621 15:45

测试红外线是否存在问题，在最初的时候，由于PIN脚问题不足，我尝试使用L298N的5V供电为红外线供电，但这似乎会导致一些奇怪的问题，因此，现在纯粹使用树莓派供电进行尝试。

运行时间30s, 不断的人为在红外线前放置物品进行操作.

没有明显问题。

### 20200621 16:33

暂时蔽障功能已经ok，下面处理图像识别。

### 20200626 11:09

昨天重新测试了一下，控速功能再次出现问题，今天仔细查阅L298N资料，在使用PWM模块时，**需要拔掉跳线帽**(板载跳线帽或者使能端跳线帽均可),单独连接ENA和ENB,这是因为，跳线帽可以使板载5V为使能端供电。

### 20200626 22:46

在实际路面上进行了测试，在障碍物面前已经可以实现蔽障功能，但是对于小物体，比如椅子腿，过于细小，超声波和红外线都不能进行有效的检测，所以会发生碰撞。此外，由于没有目的地，只是简单的避障，有时候会发生在某一范围转圈的可能性，这一点是无法处理的。避障功能仅能实现不碰撞障碍物，但是转向等还没有进行有效的设置。

### 20200627 10:23

开始实现图像识别功能用于追随某物体进行处理。想要识别网球来进行跟踪处理，但是尝试了HoughCircle和HSV两种方式，都得不到较好的结果。HoughCircle对网球的检测也太垃圾了吧。我服了。

在后面的操作，我使用了高斯滤波，Canny边缘检测，然后使用HoughCircle进行圆形检测，能差不多检测出网球的位置，尽管我完全不知道为什么，因为HoughCicle明明在检测时就已经初始进行Canny边缘了，为什么还要手动Canny.

### 20200628 21:05

尝试了几个图片都还不错，但是一旦实际运行，就垃圾的没有办法，在实际环境中，噪声太多，houghcircle是无法处理的。

### 20200629 16:36

我修改了camera_pi.py中的一些代码，然后我发现，当我将Thread设置为类属性时，相机运行正常，但是一旦改成实例属性(因为我只需要一个线程)，就会十分慢，这应该是我在index.py中，每次调用video_feed都会重新定义实例的原因。所以暂时仍然使用类属性和类方法吧。但是由于我加了检测网球这一件事。所以现在的代码比较混乱，后续修改。所以我的网球无法检测也许并不是噪声的原因，而是由于_thread这一类方法不断的覆盖导致我检测出的内容没有显现。我对于类方法的操作还不是特别熟练，后续需要进一步考量。不，我想明白了，Camera这一个类只有一个线程，这才是将Thread设置为类属性的原因，所有的实例共享一个线程。

所以。。。。检测不出网球，还是因为噪声的原因吗。。。明明单独一个照片还是能很好的检测出来的。


### 20200901 17:26

我想添加上使用tensorflow来识别物品，但是树莓派获取照片的速度远超过tensorflow的处理速度，对此，我需要进行一定的修改，一个想法是降低树莓派拍照的FPS，另一个方法是在调用capture_continuous过程中进行处理，这样也变相的降低了fps。我将该版本commit.`c2205ef5435f5d1325a9269451fcbce33cb185b1`

### 20200901 23:46

我修改了代码，在capture_continueous中即进行识别，我的工作是正常的，但是为什么会出现Exception呢，`picamera.exc.PiCameraMMALError: Failed to create MMAL component b'vc.null_sink': Out of memory`

我尽力的google了相关问题，但是大多数都是因为没有初始化摄像头，无法连接摄像头，而我的问题却十分奇怪，另外，为什么我的线程经常会初始化，这是有问题的，在后面我甚至使我的Thread永远不为None.我要测试一下cls是否仍然出现这一问题，也许是实例属性的问题。

很有可能是实例属性的问题，我测试了在网球检测中的camera，显然是没有问题的，在接下来我将修改tensorflow的部分逻辑代码来尝试发现错误。当然不排除是由于上述异常的原因。

### 20200902 15:55

我是个憨批吧，我总算发现了问题，我就说明明逻辑没有一点问题，哪怕是实例属性还是类属性都不应该出现问题，因为我只是初始化了一个实例。我今天首先将实例属性全部转换为类属性，但是依然出现问题。后续我继续观察了关于线程创建时的问题，我发现我只是因为将Thread的第一个字母小写了而已(我果然是一个憨批)。

我觉得这类问题是很明显不应出现的，甚至是查错也应该是迅速的，这一问题发生在我添加了线程之后，而在添加线程之前程序测试是没有问题的，所以**我应该将主要的注意力放在线程方面**。而不是纠结于实例属性与类属性，甚至尝试了去更新摄像头硬件。

### 20200908 22:29

想要在index中添加一个自动蔽障的功能，在shelter文件中，使用线程的方法来处理蔽障功能，这样可以保证在逻辑处理时，将蔽障功能终止。

而且要将蔽障功能放在index.py中，否则会冲突。因为index中已经进行了对Car的继承